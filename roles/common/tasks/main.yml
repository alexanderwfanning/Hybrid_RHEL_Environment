- name: Install base packages
  dnf:
    name:
      - nano
      - git
      - curl
      - wget
      - firewalld
      - policycoreutils-python-utils
    state: present

- name: Start and enable firewalld
  systemd:
    name: firewalld
    state: started
    enabled: yes

- name: Allow SSH through firewall
  ansible.posix.firewalld:
    service: ssh
    permanent: yes
    state: enabled

- name: Set timezone
  community.general.timezone:
    name: America/Indianapolis

- name: Deploy health check script
  copy:
    src: health-check.sh
    dest: /usr/local/bin/health-check.sh
    mode: '0755'
    owner: root
    group: root

- name: Create health check cron job
  cron:
    name: "Health Check"
    minute: "*/5"
    job: "/usr/local/bin/health-check.sh"
    user: root
